# Abstract
本研究探索了一种基于预定义简单参数化图元（如三角形、矩形、圆形和半圆形）组合的新型图像几何抽象范式，旨在实现图像中可控的形状编辑。虽然该任务被视为混合的组合优化和连续优化问题，但在模型设计中，它被近似重构为token翻译神经框架，该框架能够同时输出图元的分配结果及其对应的变换参数和颜色参数，以image-to-set的方式进行处理，从而避免了复杂的、不可微分的图匹配迭代过程。

为了缩小搜索空间并解决梯度消失问题，研究引入了一种新颖的神经软分配（Neural Soft Assignment）方案，该方案巧妙地利用了二分图b匹配和基于透明度的加权多重光栅化组合之间的准等价性，大幅降低了优化的复杂度。在没有图像抽象标签（即矢量化表示）的情况下，该框架采用自监督的方式，通过可微分的光栅化技术完成端到端训练。

在多个数据集上的大量实验表明，与现有的图像抽象和图像矢量化方法相比，我们的框架仅使用四种简单图元的组合，就能生成高度吸引人的矢量化几何抽象结果。同时，该方法具有极简的形状编辑能力——只需替换图元类型，即可完成灵活编辑。这一特点显示了本方法在图像几何抽象领域的高效性和实用性。
# 1. Introduction
图像抽象，作为计算机视觉中的一个基本任务，最初旨在将给定的图像分解成一组基本的原始元素（例如，基本形状、曲线）以及它们之间的相互关系，目的是为了视觉理解或对象重建[6, 14, 13]。Haeberli等人[16]使用纹理映射作为绘画和抗锯齿文本绘制的原始元素；而Hu等人[19]采用统计学习策略，通过一组自然图像块来近似鬼成像（Ghost Imaging，简称GI[30]）。当代的抽象方法[24, 41, 20, 28]深入研究用参数化草图来表示图像。这些方法通常基于贝塞尔（Be ́zier）控制点来表示草图，输入图像被递归地转换成一系列贝塞尔曲线，基于深度架构如Transformers[34]或强化学习[28]。

除了草图，基于几何形状原始元素（如三角形、圆形等）的图像抽象方法[9, 39]可能更受频繁应用的欢迎，例如平面设计、工业设计、卡通制作、广告制作和现代艺术，基于以下事实：**1. 简单性和表达性**：一方面，几何原始元素具有非常紧凑和明确的参数格式，因此便于紧凑表示和方便操作。另一方面，几何原始元素的众多组合意味着与草图相比具有丰富的表达能力。例如，包豪斯和立体主义艺术倾向于仅采用简单的形状，如矩形和球体，但仍然具有极其丰富的艺术表现力。**2. 语义保留**：人类倾向于将复杂的视觉模式抽象成一些原始元素及其组合。例如，一个大圆圈、两个小圆圈和两个三角形就足以构成一个人脸。这两个主要原因使得现代标志设计和动画特别倾向于使用几何原始元素。本工作致力于几何原始元素的学习，以便重新组装和编辑艺术图像。

不幸的是，寻找（甚至近似）上述问题的最佳解决方案被认为是困难的，因为它本质上同时涉及组合（一种对多种原始类型选择的多对一匹配）和连续（对特定原始的最佳变换参数的推断）问题。必须解决以下挑战：

1. **高维性**：与仅需要预测控制点位置的基于草图的方法相比，几何抽象需要选择原始类型，导致组合空间呈指数级增长。此外，还需要同时预测更复杂的变换参数，如仿射系数和颜色，这进一步扩大了优化空间。
    
2. **非可微性**：请注意，原始选择的非可微性质与原始到像素的光栅化过程使得使用任何现成的深度学习框架的难度加倍。更严重的是，原始内部的封闭区域通常是平坦且无纹理的，因此流行的可微光栅化技术（例如Diffvg [23]）很难捕获向后传播的准确梯度信号，用于原始类型或变换参数校正，即所谓的梯度消失问题[18]。这个问题使得训练过程极不稳定，难以生成有意义的抽象结果。
    
3. **弱监督**：尽管在无/自监督表示学习方面取得了稳步进展，并在多个2D/3D视觉任务[17, 8, 47, 26, 25]上取得了令人鼓舞的结果，但现有的图像抽象方法[3, 28, 31]大多依赖于大量数据集（例如Quickdraw [15]）和精心设计的代价度量[41, 11]，其中矢量化草图标记可用于直接/强成对监督。然而，在这项工作中，我们只有光栅化图像用于训练，没有任何图像到矢量或图像到原始的标记，因此原始分配任务是在无监督（或自监督）设置中进行的，因为大规模高质量的参数化/矢量化格式的艺术图像极难收集。


为了追求几何抽象并解决上述困难，我们提出了一种新颖的图像几何抽象范式，该范式基于从预定义的简单参数化原始元素池（三角形、矩形、圆形和半圆形）中组装，便于在图像中进行可控的形状编辑。我们的框架具有以下设计特点：
在架构上，上述任务在令牌翻译神经框架（即变换器架构[40]）内被近似地重新构想，该框架同时输出原始分配和相应的变换参数以及颜色，以图像到集合的方式，从而绕过了复杂/不可微的原始分配迭代。为了避免穷举组合搜索，我们引入了一种新颖的神经软分配方案，该方案很好地探索了二分图b-匹配中的选择操作和透明度感知的加权多重光栅化组合之间的准等价性。也就是说，对于每个考虑的图像位置，首先融合多个原始选择（带有估计的变换），然后软性推断原始匹配权重作为不透明度值，以支持原始分配的可微学习。
此外，为了解决梯度消失的挑战，我们提出了一种质心过滤机制来校准封闭区域内的梯度，在该机制的核心是一个质心平滑核，为平坦原始创建了有效的梯度传播路径。在没有真实抽象图像标记（即矢量化表示）的情况下，整个流程可以通过基于可微光栅化技术的链接[23]以无监督的方式进行端到端训练。

我们在多个数据集上对提出的框架进行了广泛的实验，包括定性分析和定量分析，这些数据集包括表情符号[2]、图标[1]和包豪斯风格的平面设计。实验结果表明，我们的方法仅使用少量简单的几何形状原始原型就能生成极具吸引力的结果。与容易产生冗余和不匹配曲线的基于草图的方法相比，我们的方法实现了几个原始元素的紧凑组合，并具有良好的近似精度。此外，我们的方法可以通过在推理过程中简单地替换/编辑原始类型来生成具有丰富语义的新矢量化形状，这也表明了它在现代平面设计中的巨大应用潜力。

# 2. Related Works
## Image Abstraction
当代的图像抽象技术主要侧重于使用草图来表示图像，因为草图的简单性[36, 22, 31]。最近的努力[11, 41, 39]利用CLIP[32]模型来促进图像抽象，因为CLIP模型具有从草图和图像中提取语义概念的显著能力。例如，CLIPasso[41]使用预训练的CLIP模型提供几何和语义指导，并为输入图像生成具有多个抽象级别的草图。除了基于草图的图像抽象，几何抽象[9]是另一个有影响力的图像抽象范式。Tian等人[39]结合CLIP模型和进化策略[5]，通过优化参数化三角形的过程放置来抽象图像。然而，显然仅用三角形来有效地抽象具有不同结构的图像是不够的。此外，[39]中的结果仅限于完全语义（CLIP引导）或颜色均值误差（MSE引导）。在我们的工作中，我们探索了包含多种几何元素（如矩形和圆形等）的原始元素集合的几何抽象。我们的任务需要额外选择原始元素，这是不可微的，增加了优化的难度。

## Image Vectorization
我们的方法使用矢量图形原始元素来表示输入图像。在这个领域的先前工作[10, 44, 46]专注于预先分割图像，然后将分割的组件回归到矢量图形。在深度学习时代，研究人员使用可微渲染/光栅化[23]来进行图像矢量化。Im2Vec[33]提出了一个基于RNN的VAE模型，用于预测光栅图像的矢量路径，而无需矢量监督。LIVE[27]强调了路径初始化在图像矢量化任务中的重要性，提出了组件-wise路径初始化，并以分层方式优化矢量图形。尽管LIVE取得了引人注目的矢量化结果，但由于其单次传递优化，效率较低。

我们的方法将图像矢量化表述为图像到集合的问题，并通过简单参数化原始元素的组合高效地合成高质量/规则的矢量图形。

## Reconstruction with primitives
我们的工作还与基于原始元素的重建相关，这在CAD设计[12, 35, 29, 48]和图像/草图压缩[3, 43, 45, 38]中常用。一个密切相关的工作是PMN[3]，它通过以监督的方式将草图与预定义的原始元素匹配来抽象草图，得益于大规模草图数据集。与上述方法不同，我们的工作提出了一个更加困难的任务：在没有矢量图形监督的情况下，用预定义的参数化原始元素重建光栅图像。

# 3. Methodology
## 3.1. Problem Definition

## 3.2. Shape Attribute Set Prediction

## 3.3. Bipartite b-Matching with Neural Soft Assignment

## 3.4. Training Objectives

